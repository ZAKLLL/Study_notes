# 运行时获取泛型

Java 泛型擦除是 Java 泛型中的一个重要特性，其目的是避免过多的创建类而造成的运行时的过度消耗。所以，想 ArrayList<Integer> 和 ArrayList<String> 这两个实例，其类实例是同一个。

但很多情况下我们又需要在运行时获得泛型信息，那我们可以通过定义类的方式（通常为匿名内部类，因为我们创建这个类只是为了获得泛型信息）在运行时获得泛型参数，从而满足例如序列化、反序列化等工作的需要。

```java
package testpackage;

import java.lang.reflect.Method;
import java.lang.reflect.ParameterizedType;
import java.lang.reflect.Type;
import java.util.ArrayList;
import java.util.List;

public class MethodDemo {

    public static void main(String[] args) {
        SampleClass<String> stringSampleClass = new SampleClass<>();
        Method[] methods = stringSampleClass.getClass().getMethods();

        Type returnType2 = methods[0].getParameterTypes()[0];
        Type returnType3 = methods[0].getGenericParameterTypes()[0];
        System.out.println(returnType2);
        System.out.println(returnType3);
        //在后方加入一个{} 实现一个匿名内部类,对泛型参数进行了限制,通过定义类的方式保留了泛型信息
        List<SampleClass<String>> list = new ArrayList<SampleClass<String>>() {
        };
        ParameterizedType parameterizedType = (ParameterizedType) list.getClass().getGenericSuperclass();
        for (Type actualTypeArgument : parameterizedType.getActualTypeArguments()) {
            System.out.println(actualTypeArgument);
        }

    }
}

class SampleClass<E> {
    public void T(List<SampleClass<String>> list) {
        return;
    }
}
```